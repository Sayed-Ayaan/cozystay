<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - All Bookings</title>
  <link rel="stylesheet" href="admin.css" />
    <link rel="stylesheet" href="header.css" />

</head>

<body>
  <header>
    <div class="container">
      <h1 id="heading">CozyStays Hotel</h1>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="rooms.html">Rooms</a></li>
          <li><a href="amenities.html">Amenities</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <h1>All Bookings</h1>
    <table id="bookingsTable">
      <thead>
        <tr>
          <th>Booking ID</th>
          <th>Customer Name</th>
          <th>Phone Number</th>
          <th>Room Number</th>
          <th>Room Type</th>
          <th>Check-In</th>
          <th>Check-Out</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>

  <footer>
    <div class="container">
      <p style='color: white;'>&copy; 2025 CozyStays Hotel. All rights reserved.</p>
    </div>
  </footer>

  <script>
    async function loadBookings() {
      try {
        const response = await fetch('/admin/bookings');
        if (!response.ok) throw new Error('Failed to fetch bookings');
        const bookings = await response.json();
        const tbody = document.querySelector('#bookingsTable tbody');
        tbody.innerHTML = '';

        bookings.forEach(booking => {
          const tr = document.createElement('tr');

          const checkInDate = new Date(booking.check_in_date);
          const checkOutDate = new Date(booking.check_out_date);

          const formattedCheckInDate = `${checkInDate.getDate().toString().padStart(2, '0')}/${(checkInDate.getMonth() + 1).toString().padStart(2, '0')}/${checkInDate.getFullYear()}`;
          const formattedCheckOutDate = `${checkOutDate.getDate().toString().padStart(2, '0')}/${(checkOutDate.getMonth() + 1).toString().padStart(2, '0')}/${checkOutDate.getFullYear()}`;

          tr.innerHTML = `
            <td>${booking.booking_id}</td>
            <td>${booking.full_name}</td>
            <td>${booking.phone_number}</td>
            <td>${booking.room_no}</td>
            <td>${booking.room_type}</td>
            <td>${formattedCheckInDate}</td>
            <td>${formattedCheckOutDate}</td>
          `;
          tbody.appendChild(tr);
        });
      } catch (error) {
        alert(error.message);
      }
    }

    loadBookings();
  </script>
</body>

</html>
